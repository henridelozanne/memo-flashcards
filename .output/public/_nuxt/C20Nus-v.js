import{d as h,x as a,y as i,z as t,A as c,J as N,D as v,K as b,L as C,M as R,r as k,k as L,o as V,N as w,O as s,P as A,Q as P,C as $}from"./BzQlD_xP.js";import{_ as z}from"./BebTYC0G.js";import{u as J}from"./AebXkaNM.js";import{u as K}from"./CkUdmUOO.js";const O={class:"font-semibold text-lg mb-2"},Q={class:"text-gray-500 text-sm mb-4"},q={class:"flex gap-2 mt-auto"},G=h({__name:"CollectionCard",props:{collection:{},onEdit:{type:Function},onDelete:{type:Function},onClick:{type:Function}},setup(r){const u=r;function x(){u.onClick&&u.onClick(u.collection.id)}return(f,n)=>(i(),a("div",{class:"flex flex-col border rounded-lg p-4 bg-white shadow hover:shadow-md transition cursor-pointer",onClick:x},[t("div",O,c(r.collection.name),1),t("div",Q,[N(f.$slots,"info",{},()=>[n[2]||(n[2]=v("0 cartes",-1))])]),t("div",q,[r.onEdit?(i(),a("button",{key:0,class:"text-xs text-blue-600 hover:underline",onClick:n[0]||(n[0]=C(m=>r.onEdit(r.collection.id),["stop"]))},"Modifier")):b("",!0),r.onDelete?(i(),a("button",{key:1,class:"text-xs text-red-500 hover:underline",onClick:n[1]||(n[1]=C(m=>r.onDelete(r.collection),["stop"]))},"Supprimer")):b("",!0)])]))}}),H={class:"min-h-screen bg-gray-50 p-6"},I={class:"flex items-center justify-between mb-6"},U={class:"flex gap-2"},W={key:0,class:"flex justify-center items-center py-12","data-testid":"loading"},X={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},Y={class:"mb-6"},Z=["disabled"],_={key:2,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},ne=h({__name:"index",setup(r){const u=R(),{collections:x,isLoading:f,error:n,loadCollections:m,deleteCollection:D}=J(),{getCardsDueToday:S,getCardsCount:y}=K(),d=k(null),g=k(!1),p=L(()=>S().length);V(()=>{m()});function T(o){u.push(`/collections/${o}/edit`)}function E(o){d.value=o}async function M(){if(d.value){g.value=!0;try{await D(d.value.id),d.value=null}catch(o){console.error("Error deleting collection:",o)}finally{g.value=!1}}}function j(o){u.push(`/collections/${o}/cards`)}return(o,e)=>{const B=G,F=z;return i(),a("div",H,[t("div",I,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold","data-testid":"heading-collections"},"Collections",-1)),t("div",U,[t("button",{class:"bg-blue-100 text-blue-700 rounded px-3 py-1 text-sm",onClick:e[0]||(e[0]=l=>o.$router.push("/stats"))},"Stats"),e[5]||(e[5]=t("button",{class:"bg-yellow-100 text-yellow-700 rounded px-3 py-1 text-sm"},"Premium",-1)),e[6]||(e[6]=t("button",{class:"bg-gray-200 text-gray-700 rounded px-3 py-1 text-sm"},"Aide",-1))])]),s(f)?(i(),a("div",W,[...e[8]||(e[8]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("span",{class:"ml-2 text-gray-600"},"Chargement des collections...",-1)])])):s(n)?(i(),a("div",X,[v(c(s(n))+" ",1),t("button",{class:"ml-2 underline",onClick:e[1]||(e[1]=(...l)=>s(m)&&s(m)(...l))},"Réessayer")])):b("",!0),t("div",Y,[t("button",{class:"w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-4 rounded-xl font-semibold text-lg shadow-lg hover:from-blue-600 hover:to-blue-700 transition flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-blue-500 disabled:hover:to-blue-600","data-testid":"daily-review-btn",disabled:p.value===0,onClick:e[2]||(e[2]=l=>o.$router.push("/daily-review"))},c(p.value>0?o.$t("dailyReview.reviewToday",p.value,{count:p.value}):o.$t("dailyReview.noCardsToday")),9,Z)]),!s(f)&&!s(n)?(i(),a("div",_,[t("div",{"data-testid":"create-card",class:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-lg p-6 bg-white cursor-pointer hover:bg-blue-50 transition order-last",onClick:e[3]||(e[3]=l=>o.$router.push("/collections/create"))},[...e[9]||(e[9]=[t("span",{class:"text-4xl text-blue-400 mb-2"},"+",-1),t("span",{class:"font-medium text-blue-700 text-center"},"Créer une collection",-1)])]),(i(!0),a(A,null,P(s(x),l=>(i(),w(B,{key:l.id,collection:l,"on-edit":T,"on-delete":E,"on-click":j},{info:$(()=>[v(c(s(y)(l.id))+" "+c(s(y)(l.id)<=1?"carte":"cartes"),1)]),_:2},1032,["collection"]))),128))])):b("",!0),d.value?(i(),w(F,{key:3,open:!!d.value,title:"Supprimer la collection","confirm-label":"Supprimer",loading:g.value,onCancel:e[4]||(e[4]=l=>d.value=null),onConfirm:M},{default:$(()=>{var l;return[v(' Êtes-vous sûr de vouloir supprimer la collection "'+c((l=d.value)==null?void 0:l.name)+'" ? ',1),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=t("span",{class:"text-sm text-gray-500"},"Cette action est irréversible.",-1))]}),_:1},8,["open","loading"])):b("",!0)])}}});export{ne as default};
