import{_ as B}from"./CKD7xOmG.js";import{d as S,U as V,V as N,r,o as T,x as d,z as s,K as _,A as n,D as A,B as E,O as F,R as M,M as z,y as m}from"./BzQlD_xP.js";import{u as D}from"./AebXkaNM.js";import{u as I}from"./CkUdmUOO.js";const j={class:"min-h-screen bg-gray-50 p-6"},K={class:"max-w-md mx-auto"},O={class:"flex items-center mb-6"},P={class:"text-2xl font-bold","data-testid":"heading-create-card"},U={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},q={class:"text-sm text-blue-700"},G={class:"font-medium"},H={class:"bg-white rounded-lg shadow p-6","data-testid":"create-card-form"},Y=S({name:"CreateCardPage",__name:"create",setup(J){const h=N(),f=z(),{t:v}=V(),{collections:y,loadCollections:C,getCollection:x}=D(),{createCard:k}=I(),l=String(h.params.id),c=r(null),i=r(!1),a=r(null),b=r();async function w(){y.value.length||await C(),c.value=x(l)}async function p(t,e,u){var o;i.value=!0,a.value=null;try{await k(t,e,l),a.value={type:"success",text:v("cards.createdSuccess")},u?(setTimeout(()=>{a.value=null},2e3),(o=b.value)==null||o.reset()):setTimeout(()=>{f.push(`/collections/${l}/cards`)},1500)}catch(g){a.value={type:"error",text:g instanceof Error?g.message:v("cards.createdError")}}finally{i.value=!1}}async function $(t,e){await p(t,e,!1)}async function R(t,e){await p(t,e,!0)}return T(w),(t,e)=>{const u=B;return m(),d("div",j,[s("div",K,[s("div",O,[s("button",{class:"mr-4 text-gray-600 hover:text-gray-800","aria-label":"Retour",onClick:e[0]||(e[0]=o=>t.$router.back())},[...e[2]||(e[2]=[s("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),s("h1",P,n(t.$t("cards.createTitle")),1)]),c.value?(m(),d("div",U,[s("p",q,[s("span",G,n(t.$t("collections.collection"))+":",1),A(" "+n(c.value.name),1)])])):_("",!0),s("div",H,[E(u,{ref_key:"cardFormRef",ref:b,"is-submitting":i.value,"submit-label":t.$t("common.add"),"show-add-another":!0,onSubmit:$,onAddAnother:R,onCancel:e[1]||(e[1]=o=>F(f).back())},null,8,["is-submitting","submit-label"])]),a.value?(m(),d("div",{key:1,class:M(["mt-4 p-4 rounded-md",a.value.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},n(a.value.text),3)):_("",!0)])])}}});export{Y as default};
